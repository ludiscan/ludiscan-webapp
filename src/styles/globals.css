/**
 * Global styles and design tokens
 * Following Material Design 3, WCAG 2.2, and Design Implementation Guide
 */

/* Import generated design tokens (CSS Custom Properties) */
@import './tokens/tokens.css';

/**
 * Base styles with accessibility and responsive design
 */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html {
  /* Enable smooth scrolling for accessibility */
  scroll-behavior: smooth;

  /* Prevent text size adjustment on orientation change */
  -webkit-text-size-adjust: 100%;
  -moz-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

body {
  margin: 0;
  padding: 0;

  /* Fluid typography using design tokens */
  font-size: var(--typography-font-size-base);
  line-height: var(--typography-line-height-normal); /* WCAG 2.2 recommended 1.5 */
  font-weight: var(--typography-font-weight-regular);

  /* Use system fonts for better performance and native feel */
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;

  /* Improve font rendering */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  /* Prevent horizontal overflow */
  overflow-x: hidden;
}

/**
 * Accessibility: Focus visible styles (WCAG 2.2 compliant)
 */
*:focus-visible {
  outline: var(--accessibility-focus-ring-width) solid var(--color-primary-80);
  outline-offset: var(--accessibility-focus-ring-offset);
  border-radius: var(--border-radius-sm);
}

/**
 * Remove default focus outline for mouse users (but keep for keyboard)
 * This is handled by :focus-visible above
 */
*:focus:not(:focus-visible) {
  outline: none;
}

/**
 * Logical properties for text alignment (RTL/LTR support)
 */
[dir='ltr'] {
  text-align: start;
}

[dir='rtl'] {
  text-align: start;
}

/**
 * Improve readability with max line length
 */
p,
li,
blockquote {
  max-inline-size: var(--layout-max-line-length); /* 65ch for optimal readability */
}

/**
 * Headings with fluid typography
 */
h1 {
  font-size: var(--typography-font-size-4xl);
  line-height: var(--typography-line-height-tight);
  font-weight: var(--typography-font-weight-bold);
  margin-block: var(--spacing-lg) var(--spacing-md);
}

h2 {
  font-size: var(--typography-font-size-3xl);
  line-height: var(--typography-line-height-tight);
  font-weight: var(--typography-font-weight-bold);
  margin-block: var(--spacing-lg) var(--spacing-md);
}

h3 {
  font-size: var(--typography-font-size-2xl);
  line-height: var(--typography-line-height-tight);
  font-weight: var(--typography-font-weight-semibold);
  margin-block: var(--spacing-md) var(--spacing-sm);
}

h4 {
  font-size: var(--typography-font-size-xl);
  line-height: var(--typography-line-height-normal);
  font-weight: var(--typography-font-weight-semibold);
  margin-block: var(--spacing-md) var(--spacing-sm);
}

h5 {
  font-size: var(--typography-font-size-lg);
  line-height: var(--typography-line-height-normal);
  font-weight: var(--typography-font-weight-medium);
  margin-block: var(--spacing-sm) var(--spacing-xs);
}

h6 {
  font-size: var(--typography-font-size-base);
  line-height: var(--typography-line-height-normal);
  font-weight: var(--typography-font-weight-medium);
  margin-block: var(--spacing-sm) var(--spacing-xs);
}

/**
 * Links with accessible focus and hover states
 */
a {
  color: var(--color-primary-80);
  text-decoration: underline;
  text-decoration-thickness: 2px;
  text-underline-offset: 2px;
  transition: color 0.2s ease;
}

a:hover {
  color: var(--color-primary-90);
}

a:focus-visible {
  outline: var(--accessibility-focus-ring-width) solid var(--color-primary-80);
  outline-offset: var(--accessibility-focus-ring-offset);
}

/**
 * Buttons with minimum touch target size (WCAG 2.2 SC 2.5.8)
 */
button {
  min-block-size: var(--touch-target-min-size-mobile); /* 44px for mobile */
  min-inline-size: var(--touch-target-min-size-mobile); /* 44px for mobile */
  cursor: pointer;
}

button:disabled {
  cursor: not-allowed;
  opacity: 0.38; /* Material Design 3 disabled opacity */
}

/**
 * Form inputs with logical properties
 */
input,
textarea,
select {
  font-size: var(--typography-font-size-base);
  padding-block: var(--spacing-sm);
  padding-inline: var(--spacing-sm);
  border: var(--border-width-thin) solid var(--color-neutral-80);
  border-radius: var(--border-radius-sm);
}

input:focus,
textarea:focus,
select:focus {
  outline: var(--accessibility-focus-ring-width) solid var(--color-primary-80);
  outline-offset: var(--accessibility-focus-ring-offset);
  border-color: var(--color-primary-80);
}

/**
 * Invalid input states
 */
input[aria-invalid='true'],
textarea[aria-invalid='true'],
select[aria-invalid='true'] {
  border-color: var(--color-error-60);
}

/**
 * Lists with logical spacing
 */
ul,
ol {
  padding-inline-start: var(--spacing-lg);
  margin-block: var(--spacing-md);
}

li {
  margin-block: var(--spacing-xs);
}

/**
 * Images and media
 */
img,
video,
canvas,
svg {
  display: block;
  max-inline-size: 100%;
  block-size: auto;
}

/**
 * Code blocks
 */
code,
pre {
  font-family: 'Fira Code', 'Courier New', monospace;
  font-size: var(--typography-font-size-sm);
  line-height: 1.6; /* Slightly more spacing for code readability */
}

pre {
  padding: var(--spacing-md);
  border-radius: var(--border-radius-md);
  overflow-x: auto;
  background-color: var(--color-neutral-95);
}

/**
 * Tables with logical properties
 */
table {
  border-collapse: collapse;
  inline-size: 100%;
  margin-block: var(--spacing-md);
}

th,
td {
  padding-block: var(--spacing-sm);
  padding-inline: var(--spacing-md);
  border-block-end: var(--border-width-thin) solid var(--color-neutral-90);
  text-align: start;
}

th {
  font-weight: var(--typography-font-weight-semibold);
  background-color: var(--color-neutral-99);
}

/**
 * Utility classes for accessibility
 */
.sr-only {
  position: absolute;
  inline-size: 1px;
  block-size: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/**
 * Reduced motion for accessibility (WCAG 2.2)
 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/**
 * Dark mode support (using prefers-color-scheme)
 */
@media (prefers-color-scheme: dark) {
  :root {
    /* Override token values for dark mode if needed */
    /* This will be enhanced when we implement theme switching */
  }
}

/**
 * High contrast mode support
 */
@media (prefers-contrast: high) {
  * {
    border-width: var(--border-width-thick);
  }
}
